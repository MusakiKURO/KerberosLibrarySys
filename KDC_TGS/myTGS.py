import datetime
import json
from random import random

from werkzeug.security import generate_password_hash

from RSA.demo_RSA import RSA_call


class myTGS:

    def __init__(self):
        self.pKey = 14220740661786976075675484623124052254340247802148417953610565874929344370990160272496763287697887046488412860516140652697481778540855238640459761025038289099157228983802767721981144334696822749252844010939010650982385066579660472052903373434694773981620284873744629391760163314379404877893893830380183489587092045771675932640410147971024868813649655435174684648383133844519036758245419838996354750519894444497111923680728163499972430979364192040736679729753637059055728567923233332769769871876953627404607873684684160726342106273987685360916603193012258592402006915529292108505528446791863340231851499687122542135669
        self.sKey = 11088085323058951088194718468065963809707289968869251833765657814805216860057634464876094481000992234547780599850081440298477484221702285648221520490401705494101567070087453356016242359323857400961599233394623560205683459758924731402160037574391610089885050537076011442680384292304920720514792784723551220194504377711863943736386695266582777078417547844050682645898493076915367194528605178758376493593347535909210633380372427613442488820455934576107941882610731347354040440402701256658054138541204052213518159717834596831041571266118419547907155814200537861651127258322924866528549026560868077022568496698160229001473
        self.EKtgs = "11111111"


class msgCtoT:

    def __init__(self, ID_v, ticket_tgs):
        self.id_v = ID_v
        self.ticket_tgs = ticket_tgs


class ticket_tgs:
    def __init__(self, EKc_tgs, ID_c, AD_c, ID_tgs, TS_2, Lifetime_2):
        self.EKc_tgs = EKc_tgs
        self.id_c = ID_c
        self.ad_c = AD_c
        self.id_tgs = ID_tgs
        self.ts_2 = TS_2
        self.lifetime_2 = Lifetime_2


class ticket_v:
    def __init__(self, id_c, ad_c, id_v, ts_4):
        seed = "1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"
        sa = []
        for i in range(8):
            sa.append(random.choice(seed))
        result = ''.join(sa)
        self.EKc_v = result
        self.id_c = id_c
        self.ad_c = ad_c
        self.id_v = id_v
        self.ts_4 = ts_4
        self.lifetime_4 = (datetime.datetime.now()+datetime.timedelta(minutes=5)).strftime("%Y-%m-%d %H:%M:%S")
