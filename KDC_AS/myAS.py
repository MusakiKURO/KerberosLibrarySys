# coding=utf-8
import datetime
import random
import json


from werkzeug.security import generate_password_hash

from RSA.demo_RSA import RSA_call


class myAS:

    def __init__(self):
        self.pKey = 3154524864060864374678451683785718402763405879146890491724664939645203946720547999949914217988518171750442418164607972417886195034362711226485418090182244227302447541186973733483464033984189667761796827741079639931123803417438545627319420211895141018230052852282054657816721996634088748902963118173646405921325251595289523097960744361920052328324763552082601036203542971235280005631770562170683186175141376336290714492185920922938387369254486603274876452521823106930391534430591715961317922064788106395009561894542301754552240585726394934679113208017542471920011881673470137586116357477440647703346142468530016520721
        self.sKey = 46208155232897901943807522718987589707384678028915190992197969727930722932873431495978113878709392326173378724049371401211083010100984219256694712400246493709055184697796584893176762327003403894766695982901818123104183152734196008395664180591411498504674469966442963081985033138055223750657561277548568742607930841370467181838938224220146263084906859210409331342014259529147676447743956246406207635534153009989102097371654411928251651146150897767918673659121141136736827874109137846992571374515725993944656407671110428274379442278052200277489961831219425908455297367981451238069320319055904678698062056760825644033
        self.EKtgs = "11111111"


class msgCtoA:

    def __init__(self, ID_c, ID_tgs, TS_1):
        self.id_c = ID_c
        self.id_tgs = ID_tgs
        self.ts_1 = TS_1


class ticket_tgs:
    def __init__(self, ID_c, addr, TS_2):
        seed = "1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"
        sa = []
        for i in range(8):
            sa.append(random.choice(seed))
        result = ''.join(sa)
        self.EKc_tgs = result
        self.id_c = ID_c
        self.ad_c = addr
        self.id_tgs = "TGS"
        self.ts_2 = TS_2
        self.lifetime_2 = (datetime.datetime.now() + datetime.timedelta(minutes=5)).strftime("%Y-%m-%d %H:%M:%S")


class msgAtoC:
    def __init__(self, TS_2, EKc_tgs):
        self.lifetime_2 = (datetime.datetime.now() + datetime.timedelta(minutes=5)).strftime("%Y-%m-%d %H:%M:%S")
        self.id_tgs = "TGS"
        self.Ekc_tgs = EKc_tgs
        self.ts_2 = TS_2
